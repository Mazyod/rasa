---
id: entities
sidebar_label: Entities
title: Entities
description: Read more about how to define and use entities.
abstract: This page explains in detail how you can use entities and what kind of variations exist.
---

Entities are part of the [NLU training data](./training-data-format.mdx#nlu-training-data).
Entities are structured pieces of information that can be extracted from a user's message.

### Entity Roles and Groups

:::caution
This feature is experimental.
We introduce experimental features to get feedback from our community, so we encourage you to try it out!
However, the functionality might be changed or removed in the future.
If you have feedback (positive or negative) please share it with us on the [forum](https://forum.rasa.com).
:::

Assigning custom entity labels to words, allow you to define certain concepts in the data.
For example, you can define what a city is:

```
I want to fly from [Berlin]{"entity": "city"} to [San Francisco]{"entity": "city"}.
```

However, sometimes you want to specify entities even further.
Let's assume you want to build an assistant that should book a flight.
The assistant needs to know which of the two cities in the example above is the departure city and which is the
destination city.
`Berlin` and `San Francisco` are still cities, but they play a different role in our example.
To distinguish between the different roles, you can assign a role label in addition to the entity label.

```
- I want to fly from [Berlin]{"entity": "city", "role": "departure"} to [San Francisco]{"entity": "city", "role": "destination"}.
```

You can also group different entities by specifying a group label next to the entity label.
The group label can, for example, be used to define different orders.
In the following example the group label indicates what toppings goes with which pizza and
what size which pizza has.

```
Give me a [small]{"entity": "size", "group": "1"} pizza with [mushrooms]{"entity": "topping", "group": "1"} and
a [large]{"entity": "size", "group": "2"} [pepperoni]{"entity": "topping", "group": "2"}
```

See [Training Data Format](training-data-format.mdx#entities) for details on how to define entities with roles and
groups in your training data.

The entity object returned by the extractor will include the detected role/group label.

```json
{
  "text": "Book a flight from Berlin to SF",
  "intent": "book_flight",
  "entities": [
    {
      "start": 19,
      "end": 25,
      "value": "Berlin",
      "entity": "city",
      "role": "departure",
      "extractor": "DIETClassifier",
    },
    {
      "start": 29,
      "end": 31,
      "value": "San Francisco",
      "entity": "city",
      "role": "destination",
      "extractor": "DIETClassifier",
    }
  ]
}
```

:::note
Entity roles and groups are currently only supported by the [DIETClassifier](./components.mdx#dietclassifier) and
[CRFEntityExtractor](./components.mdx#crfentityextractor).
:::

In order to properly train your model with entities that have roles/groups, make sure to include enough training data
examples for every combination of entity and role/group label.
Also make sure to have some variations in your training data, so that the model is able to generalize.
For example, you should not only have examples like `fly FROM x TO y`, but also include examples like
`fly TO y FROM x`.

To fill slots from entities with a specific role/group, you need to either define a custom slot mappings using
[Forms](forms.mdx) or use [Custom Actions](custom-actions.mdx) to extract the corresponding entity directly from the
tracker.


### Entity with BILOU tagging

[DIETClassifier](./components.mdx#dietclassifier) and [CRFEntityExtractor](./components.mdx#crfentityextractor)
have the option `BILOU_flag`.
`BILOU` is short for `Beginning, Inside, Last, Outside, and Unit-length` and refers to a tagging schema that can be
used by the machine learning model.
For example, the training example

```
[Alex]{"entity": "person"} is going with [Marty A. Rick]{"entity": "person"} to [Los Angeles]{"entity": "location"}.
```

is first split into a list of tokens and then the machine learning model applies the tagging schema
depending on the option `BILOU_flag` during training.

| token   | BILOU tagging schema | normal tagging schema |
|---------|----------------------|----------------------|
| alex    | U-person             | person               |
| is      | O                    | O                    |
| going   | O                    | O                    |
| with    | O                    | O                    |
| marty   | B-person             | person               |
| a       | I-person             | person               |
| rick    | L-person             | person               |
| to      | O                    | O                    |
| los     | B-location           | location             |
| angeles | L-location           | location             |

The BILOU tagging schema is richer compared to the normal tagging schema. It may help to improve the
performance of the machine learning model when predicting entities.

:::note
When the option `BILOU_flag` is set to `True`, it might happen that the model is predicting inconsistent BILOU tags, e.g.
`B-person I-location L-person`. Rasa Open Source uses some heuristics to clean up the inconsistent BILOU tags.
For example, `B-person I-location L-person` would be changed into `B-person I-person L-person`.
:::
